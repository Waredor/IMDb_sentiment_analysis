# IMDb sentiment analysis

Модели логистической регрессии и RNN для задачи анализа тональности в NLP.

## Описание проекта

Данный проект решает задачу анализа тональности отзывов о фильмах.
Модели обучаются на датасете IMDb.

## Структура проекта

```
IMDb_sentiment_analysis/
├── venv/                  # Корневая папка виртуального окружения
├── configs/               # Конфигурационные файлы
│   
├── data/                  # Датасет
│   
├── logs/                  # Файлы логов
│   
├── models/                # Файлы state_dict обученных моделей
│    
├── utils/                 # Модули для построения пайплайна
│   
├── rnn_pipeline.py        # Скрипт пайплайна RNN
│   
├── log_reg_pipeline.py    # Скрипт пайплайна логистической регрессии
│ 
├── README.md              # Документация
│ 
├── .gitignore             # Файл .gitignore
│ 
└── requirements.txt       # Файл с модулями для установки
```

## Установка зависимостей
В консоли IDE программы перейдите в корневую папку проекта и активируйте виртуальную среду, если она еще не была активирована.
Введите команду
      ```
      pip install -r requirements.txt
      ``` 
для установки модулей из файла requirements.txt

## Структура конфигурационных файлов модели
В проекте используется конфигурационный файл пайплайна, находящиеся в папке configs:

### 'project_config.yaml'
Ниже будет представлено описание ключей и значений .yaml словаря в формате "ключ: тип данных (диапазон значений) - описание"
 - "data_path": str - путь к токенизированному датасету
 - "output_model_filename": str - имя .pkl файла обученной модели
 - "raw_data_path": str - путь к "сырому" датасету
 - "embeddings_dir": str - путь к файлу с предобученными эмбеддингами GloVe
 - "num_epochs": int - количество эпох обучения модели RNN
 - "batch_size": int - размер батча для модели RNN
 - "lr0": float - начальный шаг обучения модели RNN


## Работа с проектом
1. Для запуска пайплайна токенизации данных перейдите в папку utils `cd utils` и введите команду:
      ``` 
      python run tokenize_dataframe.py
      ``` 

После успешного завершения работы пайплайна токенизированный датасет будет сохранен в папке data.


2. Для запуска пайплайна создания эмбеддингов перейдите в папку utils `cd utils` и введите команду:
      ``` 
      python run make_embeddings.py
      ``` 

После успешного завершения работы пайплайна словарь с эмбеддингами будет сохранен в папке data.
Для следующих шагов необходим токенизированный датасет и словарь эмбеддингов!
В качестве предобученных эмбеддингов используется файл `glove.6B.100d.txt`

3. Для запуска пайплайна обучения модели логистической регрессии перейдите в корневую папку с проектом и введите команду: 
      ``` 
      python run log_reg_pipeline.py
      ``` 

4. Для запуска пайплайна обучения модели RNN перейдите в корневую папку с проектом и введите команду: 
      ``` 
      python run rnn_pipeline.py
      ```

После успешного завершения работы пайплайна обученная модель будет сохранена в папке models.